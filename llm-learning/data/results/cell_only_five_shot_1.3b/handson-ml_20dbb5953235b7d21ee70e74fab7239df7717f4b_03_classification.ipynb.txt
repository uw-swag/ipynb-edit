
    '''
    try:
    from sklearn.datasets import fetch_openml
    mnist = fetch_openml('mnist_784', version=1, cache=True, as_frame=False)
    mnist.target = mnist.target.astype(np.int8) # fetch_openml() returns targets as strings
    sort_by_target(mnist) # fetch_openml() returns an unsorted dataset
except ImportError:
    from sklearn.datasets import fetch_mldata
    mnist = fetch_mldata('MNIST original')
mnist["data"], mnist["target"]

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''

    '''