
    The code you provided is already well-structured and follows good practices for Python code. However, there are a few improvements that can be made:

    1. The code is quite long and complex, which can be difficult to read. It's recommended to break down the code into smaller, more manageable functions.
    
    2. The code uses hard-coded values for some parameters, which can be problematic if these values are to be changed. It's better to use environment variables or configuration files to store these values.
    
    3. The code uses a lot of magic numbers, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    4. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    5. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    6. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    7. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    8. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    9. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    10. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    11. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
    12. The code uses a lot of magic strings, which can be problematic if these values are to be changed. It's better to use constants or magic strings.
    
