```
    The code you provided is a part of a larger pipeline for data preprocessing, model training, and calibration check. 

    The pipeline includes:

    1. Loading and preprocessing the data.
    2. Splitting the data into training and testing sets.
    3. Training a logistic regression model.
    4. Running a calibration check on the model.

    The calibration check is used to check the calibration of the model. It measures the difference between the predicted probabilities and the true probabilities.

    The code is divided into several cells for better readability and understanding.

    The specific functionality split you mentioned is not clear from the provided code. If you could provide more context or clarify what you mean by "functionality split", I would be happy to help further.
